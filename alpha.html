<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <link
      rel="stylesheet"
      as="style"
      crossorigin
      href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css"
    />
    <style>
      #alpha-profile-root {
        font-family: "Pretendard Variable", Pretendard, -apple-system, BlinkMacSystemFont, "Segoe UI",
          "Apple SD Gothic Neo", "Noto Sans KR", sans-serif;
        color: #4f4f4f;
        line-height: 1.6;
      }
      #alpha-profile-root form {
        display: grid;
        gap: 28px;
      }
      #alpha-profile-root fieldset {
        margin: 0;
        padding: 0;
        border: none;
        display: grid;
        gap: 20px;
      }
      #alpha-profile-root fieldset + fieldset {
        margin-top: 40px;
      }
      #alpha-profile-root legend {
        display: flex;
        align-items: center;
        gap: 12px;
        flex-wrap: wrap;
        font-weight: 700;
        font-size: 22px;
        margin-bottom: 8px;
        color: #4f4f4f;
      }
      #alpha-profile-root .legend-title {
        display: inline-flex;
        align-items: center;
        gap: 6px;
      }
      #alpha-profile-root .legend-actions {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        margin-left: auto;
      }
      #alpha-profile-root .btn-outline {
        border: 1px solid #bfc7d8;
        background: #ffffff;
        color: #4f4f4f;
        padding: 6px 14px;
        border-radius: 8px;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        transition: background 0.2s ease, color 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;
      }
      #alpha-profile-root .btn-outline:hover {
        border-color: #5377f6;
        color: #2f49c8;
        box-shadow: 0 10px 20px rgba(83, 119, 246, 0.15);
      }
      #alpha-profile-root .btn-outline:focus-visible {
        outline: 2px solid #5377f6;
        outline-offset: 2px;
      }
      #alpha-profile-root .field-grid {
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        gap: 20px;
      }
      #alpha-profile-root .field {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }
      #alpha-profile-root label {
        font-weight: 600;
        color: #7e7e7e;
        font-size: 18px;
      }
      #alpha-profile-root .file-input {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        clip-path: inset(50%);
        border: 0;
        white-space: nowrap;
      }
      #alpha-profile-root .badge-public {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        margin-left: 8px;
        padding: 2px 8px;
        border-radius: 999px;
        background: rgba(83, 119, 246, 0.12);
        color: #5377f6;
        font-size: 12px;
        font-weight: 700;
        letter-spacing: 0.04em;
        text-transform: uppercase;
      }
      #alpha-profile-root .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
      }
      #alpha-profile-root .field-note {
        margin: 0;
        font-size: 14px;
        color: #9aa2b4;
      }
      #alpha-profile-root .field-note p {
        margin: 0 0 6px;
      }
      #alpha-profile-root .field-note p:last-child {
        margin-bottom: 0;
      }
      #alpha-profile-root .field-note ul {
        margin: 8px 0 0;
        padding-left: 18px;
        list-style: disc;
      }
      #alpha-profile-root .field-note li {
        margin-top: 4px;
      }
      #alpha-profile-root .file-drop-zone {
        border: 1px dashed #bfc7d8;
        border-radius: 12px;
        padding: 20px;
        text-align: center;
        background: #f9fbff;
        color: #7e7e7e;
        display: grid;
        gap: 10px;
        cursor: pointer;
        transition: border-color 0.2s ease, background 0.2s ease, color 0.2s ease;
      }
      #alpha-profile-root .file-drop-zone .file-drop-default {
        display: grid;
        gap: 6px;
      }
      #alpha-profile-root .file-drop-zone strong {
        font-size: 16px;
        color: #4f4f4f;
      }
      #alpha-profile-root .file-drop-zone .file-drop-hint {
        font-size: 14px;
      }
      #alpha-profile-root .file-drop-zone.is-dragover {
        border-color: #5377f6;
        background: rgba(83, 119, 246, 0.12);
        color: #4f4f4f;
      }
      #alpha-profile-root .file-drop-zone:focus-visible {
        outline: 2px solid #5377f6;
        outline-offset: 2px;
      }
      #alpha-profile-root .file-drop-zone .file-drop-selected {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        font-size: 15px;
        font-weight: 600;
        color: #4f4f4f;
      }
      #alpha-profile-root .file-drop-zone .file-drop-check {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 28px;
        height: 28px;
        border-radius: 50%;
        background: #e4ecff;
        color: #2f49c8;
        font-weight: 700;
        font-size: 18px;
      }
      #alpha-profile-root .file-drop-zone:not(.has-files) .file-drop-selected {
        display: none;
      }
      #alpha-profile-root .file-drop-zone.has-files .file-drop-default {
        display: none;
      }
      #alpha-profile-root label span.helper {
        display: block;
        margin-top: 4px;
        font-size: 15px;
        color: #6b7a90;
      }
      #alpha-profile-root input,
      #alpha-profile-root textarea,
      #alpha-profile-root select {
        border: 1px solid #d5dbea;
        background: #f9fbff;
        border-radius: 10px;
        padding: 12px 14px;
        font-size: 18px;
        font-family: inherit;
        transition: border-color 0.2s ease, box-shadow 0.2s ease;
      }
      #alpha-profile-root input:focus,
      #alpha-profile-root textarea:focus,
      #alpha-profile-root select:focus {
        outline: none;
        border-color: #5a67d8;
        box-shadow: 0 0 0 2px rgba(90, 103, 216, 0.25);
        background: #ffffff;
      }
      #alpha-profile-root textarea {
        min-height: 140px;
        resize: vertical;
      }
      #alpha-profile-root select[multiple] {
        min-height: 160px;
      }
      #alpha-profile-root .agreements-group {
        display: grid;
        gap: 12px;
        margin-top: 12px;
      }
      #alpha-profile-root .agreements {
        font-weight: 600;
        color: #7e7e7e;
        display: flex;
        align-items: flex-start;
        gap: 10px;
        border: none;
        border-radius: 0;
        padding: 0;
      }
      #alpha-profile-root .agreement-item {
        display: grid;
        gap: 6px;
      }
      #alpha-profile-root .agreement-header {
        display: flex;
        align-items: center;
        gap: 8px;
        flex-wrap: nowrap;
      }
      #alpha-profile-root .agreement-header .agreements {
        flex: 1;
        min-width: 0;
      }
      #alpha-profile-root .agreement-toggle {
        margin: 0;
        width: 28px;
        height: 28px;
        min-width: 28px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        background: #f9fbff;
        border: 1px solid #d5dbea;
        border-radius: 50%;
        color: #7e7e7e;
        cursor: pointer;
        transition: background 0.2s ease, color 0.2s ease, border-color 0.2s ease;
      }
      #alpha-profile-root .agreement-toggle:hover {
        background: rgba(83, 119, 246, 0.08);
        border-color: #b6c1df;
      }
      #alpha-profile-root .agreement-toggle::before {
        content: '\25BC';
        font-size: 12px;
        line-height: 1;
      }
      #alpha-profile-root .agreement-toggle[aria-expanded='true']::before {
        content: '\25B2';
      }
      #alpha-profile-root .agreement-toggle:focus-visible {
        outline: 2px solid #5377f6;
        outline-offset: 2px;
      }
      #alpha-profile-root .agreement-details {
        font-size: 14px;
        color: #7e7e7e;
        background: #f9fbff;
        border: 1px solid #d5dbea;
        border-radius: 8px;
        padding: 14px 16px;
      }
      #alpha-profile-root .agreements input[type='checkbox'] {
        width: 18px;
        height: 18px;
        margin-top: 3px;
      }
      #alpha-profile-root .agreements span {
        display: block;
      }
      #alpha-profile-root .textarea-small {
        min-height: 100px;
      }
      #alpha-profile-root .submit-row {
        display: flex;
        flex-direction: column;
        gap: 12px;
        align-items: center;
      }
      #alpha-profile-root button[type='submit'] {
        border: none;
        border-radius: 12px;
        background: #5377f6;
        color: #ffffff;
        font-weight: 700;
        padding: 14px 24px;
        cursor: pointer;
        font-size: 18px;
        transition: transform 0.15s ease, box-shadow 0.2s ease;
      }
      #alpha-profile-root button[type='submit']:hover:not([disabled]) {
        transform: translateY(-1px);
        box-shadow: 0 18px 40px rgba(73, 89, 245, 0.35);
      }
      #alpha-profile-root button[type='submit'][disabled] {
        cursor: not-allowed;
        opacity: 0.6;
      }
      #alpha-profile-root .form-message {
        font-size: 15px;
        font-weight: 600;
      }
      #alpha-profile-root .form-message.success {
        color: #1b7f44;
      }
      #alpha-profile-root .form-message.error {
        color: #d64545;
      }
      #alpha-profile-root .notice {
        border: 1px solid #d5dbea;
        border-radius: 16px;
        padding: 18px 20px;
        color: #4f4f4f;
        font-size: 14px;
        background: transparent;
      }
      #alpha-profile-root .modal-backdrop {
        position: fixed;
        inset: 0;
        background: rgba(17, 24, 39, 0.45);
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
        z-index: 999;
      }
      #alpha-profile-root .modal-backdrop[hidden] {
        display: none;
      }
      #alpha-profile-root .modal-dialog {
        background: #ffffff;
        border-radius: 18px;
        padding: 28px 32px;
        max-width: 360px;
        width: 100%;
        box-shadow: 0 24px 60px rgba(17, 24, 39, 0.25);
        text-align: center;
        color: #4f4f4f;
      }
      #alpha-profile-root .modal-dialog p {
        margin: 0;
        font-size: 18px;
        font-weight: 600;
      }
      #alpha-profile-root .modal-dialog button {
        margin-top: 22px;
        border: none;
        border-radius: 12px;
        background: #5377f6;
        color: #ffffff;
        font-weight: 700;
        padding: 12px 20px;
        cursor: pointer;
        font-size: 16px;
        transition: transform 0.15s ease, box-shadow 0.2s ease;
      }
      #alpha-profile-root .modal-dialog button:hover {
        transform: translateY(-1px);
        box-shadow: 0 16px 32px rgba(83, 119, 246, 0.28);
      }
      #alpha-profile-root .modal-dialog button:focus-visible {
        outline: 2px solid #2f49c8;
        outline-offset: 2px;
      }
      @media (max-width: 780px) {
        #alpha-profile-root .field-grid {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <div id="alpha-profile-root">
      <form id="profileForm" novalidate>
        <fieldset>
          <legend>
            <span class="legend-title">기본 정보</span>
            <span class="legend-actions" role="group" aria-label="임시 저장">
              <button type="button" class="btn-outline" id="draftSaveButton">임시 저장하기</button>
              <button type="button" class="btn-outline" id="draftLoadButton">임시 저장 불러오기</button>
            </span>
          </legend>
          <div class="field-grid">
            <div class="field">
              <label for="profilePhone">연락처 (처음 신청하신 휴대폰 번호와 동일하게 입력해주세요.)</label>
              <input
                id="profilePhone"
                type="tel"
                inputmode="tel"
                autocomplete="tel-national"
                placeholder="010-1234-5678"
                required
              />
            </div>
            <div class="field">
              <label for="profileMbti">
                MBTI
                <span class="badge-public" aria-hidden="true">공개</span>
                <span class="sr-only">상대방에게 공개되는 정보</span>
              </label>
              <input id="profileMbti" type="text" maxlength="8" placeholder="예: ENFP" />
            </div>
            <div class="field">
              <label for="profileJob">
                직업 / 직무
                <span class="badge-public" aria-hidden="true">공개</span>
                <span class="sr-only">상대방에게 공개되는 정보</span>
              </label>
              <input id="profileJob" type="text" placeholder="예: 중견 무역회사 해외영업" />
            </div>
            <div class="field">
              <label for="profileJobDetail">
                직업 / 직무 상세
                <span class="badge-public" aria-hidden="true">공개</span>
                <span class="sr-only">상대방에게 공개되는 정보</span>
              </label>
              <input
                id="profileJobDetail"
                type="text"
                placeholder="예: 중견 무역회사 해외영업팀 북미 파트 담당"
              />
            </div>
            <div class="field">
              <label for="profileUniversity">
                대학교 (캠퍼스)
                <span class="badge-public" aria-hidden="true">공개</span>
                <span class="sr-only">상대방에게 공개되는 정보</span>
              </label>
              <input id="profileUniversity" type="text" placeholder="예: 서울대학교 (관악캠퍼스)" />
            </div>
            <div class="field">
              <label for="profileSalaryRange">연봉 (세전 기준 / 프로필 미공개)</label>
              <select id="profileSalaryRange">
                <option value="">선택</option>
                <option value="1">1) 3000만원 미만</option>
                <option value="2">2) 3000-4000</option>
                <option value="3">3) 4000-6000</option>
                <option value="4">4) 6000-8000</option>
                <option value="5">5) 8000-1억</option>
                <option value="6">6) 1억-2억</option>
                <option value="7">7) 2억-3억</option>
                <option value="8">8) 3억 이상</option>
              </select>
            </div>
            <div class="field">
              <label for="profileSmoking">흡연</label>
              <select id="profileSmoking">
                <option value="">선택</option>
                <option value="비흡연">비흡연</option>
                <option value="사회적 흡연">사회적 흡연</option>
                <option value="흡연">흡연</option>
              </select>
            </div>
            <div class="field">
              <label for="profileReligion">종교</label>
              <select id="profileReligion">
                <option value="">선택</option>
                <option value="무교">무교</option>
                <option value="기독교">기독교</option>
                <option value="천주교">천주교</option>
                <option value="불교">불교</option>
                <option value="기타">기타</option>
              </select>
            </div>
          </div>
        </fieldset>

        <fieldset>
          <legend>세부 프로필</legend>
          <div class="field-grid">
            <div class="field">
              <label for="profileAppeal">
                추가 어필
                <span class="badge-public" aria-hidden="true">공개</span>
                <span class="sr-only">상대방에게 공개되는 정보</span>
              </label>
              <textarea
                id="profileAppeal"
                class="textarea-small"
                placeholder="예: 연매출 00억 사업가, 서울 자가 보유 등"
              ></textarea>
            </div>
            <div class="field">
              <label for="profileLikesDislikes">
                좋아하는 것 / 싫어하는 것
                <span class="badge-public" aria-hidden="true">공개</span>
                <span class="sr-only">상대방에게 공개되는 정보</span>
              </label>
              <textarea
                id="profileLikesDislikes"
                class="textarea-small"
                placeholder="예: 캠핑과 등산을 즐기며, 인스턴트 음식은 잘 먹지 않습니다."
              ></textarea>
            </div>
            <div class="field">
              <label for="profileSufficientCondition">
                충분조건
                <span class="badge-public" aria-hidden="true">공개</span>
                <span class="sr-only">상대방에게 공개되는 정보</span>
              </label>
              <p class="field-note" id="sufficientConditionNote">이런 점이 있다면 더 잘 맞을 거예요.</p>
              <textarea
                id="profileSufficientCondition"
                class="textarea-small"
                aria-describedby="sufficientConditionNote"
                placeholder="예: 서로 성장하고 응원할 수 있는 관계를 원합니다."
              ></textarea>
            </div>
            <div class="field">
              <label for="profileNecessaryCondition">
                필요조건
                <span class="badge-public" aria-hidden="true">공개</span>
                <span class="sr-only">상대방에게 공개되는 정보</span>
              </label>
              <p class="field-note" id="necessaryConditionNote">이건 꼭 맞아야 해요.</p>
              <textarea
                id="profileNecessaryCondition"
                class="textarea-small"
                aria-describedby="necessaryConditionNote"
                placeholder="예: 장거리 연애가 가능한 분을 선호합니다."
              ></textarea>
            </div>
            <div class="field">
              <label for="profileAboutMe">
                '저는 이런 사람입니다'
                <span class="badge-public" aria-hidden="true">공개</span>
                <span class="sr-only">상대방에게 공개되는 정보</span>
              </label>
              <textarea
                id="profileAboutMe"
                class="textarea-small"
                placeholder="나를 표현할 수 있는 매력 포인트, 성격, 장점 등을 작성해주세요."
              ></textarea>
            </div>
          </div>
        </fieldset>

        <fieldset>
          <legend>선호 조건</legend>
          <div class="field-grid">
            <div class="field">
              <label for="profilePreferredHeights">
                선호하는 키 (단일 선택 가능)
                <span class="badge-public" aria-hidden="true">공개</span>
                <span class="sr-only">상대방에게 공개되는 정보</span>
              </label>
              <select id="profilePreferredHeights">
                <option value="160cm 이하">160cm 이하</option>
                <option value="161-165cm">161-165cm</option>
                <option value="166-170cm">166-170cm</option>
                <option value="171-175cm">171-175cm</option>
                <option value="176-180cm">176-180cm</option>
                <option value="181cm 이상">181cm 이상</option>
              </select>
            </div>
            <div class="field">
              <label for="profilePreferredAges">
                선호 나이 (단일 선택 가능)
                <span class="badge-public" aria-hidden="true">공개</span>
                <span class="sr-only">상대방에게 공개되는 정보</span>
              </label>
              <select id="profilePreferredAges">
                <option value="20대 초반">20대 초반</option>
                <option value="20대 중반">20대 중반</option>
                <option value="20대 후반">20대 후반</option>
                <option value="30대 초반">30대 초반</option>
                <option value="30대 중반">30대 중반</option>
                <option value="30대 후반 이상">30대 후반 이상</option>
              </select>
            </div>
          </div>
        </fieldset>

        <fieldset>
          <legend>증빙 자료 및 사진</legend>
          <div class="field-grid">
            <div class="field">
              <label for="profileIdCard">
                신분증 업로드
                <span class="badge-public" aria-hidden="true">확인용</span>
                <span class="sr-only">매칭 매니저 확인용 비공개 정보</span>
              </label>
              <input id="profileIdCard" class="file-input" type="file" accept="image/*,.pdf" />
              <div
                class="file-drop-zone"
                data-target="profileIdCard"
                data-placeholder="선택된 파일 없음"
                tabindex="0"
                role="button"
                aria-label="신분증 파일을 업로드하려면 클릭하거나 파일을 끌어다 놓으세요"
              >
                <div class="file-drop-default">
                  <strong>클릭 또는 드래그해서 업로드</strong>
                  <span class="file-drop-hint">신분증 이미지 또는 PDF 파일을 첨부해주세요.</span>
                </div>
                <div class="file-drop-selected">
                  <span class="file-drop-check" aria-hidden="true">✔</span>
                  <span class="file-drop-files">선택된 파일 없음</span>
                </div>
              </div>
            </div>
            <div class="field">
              <label for="profileEmploymentProof">
                재직 증명서 / 명함 업로드
                <span class="badge-public" aria-hidden="true">확인용</span>
                <span class="sr-only">매칭 매니저 확인용 비공개 정보</span>
              </label>
              <input
                id="profileEmploymentProof"
                class="file-input"
                type="file"
                accept="image/*,.pdf"
                aria-describedby="employmentProofNote"
              />
              <div
                class="file-drop-zone"
                data-target="profileEmploymentProof"
                data-placeholder="선택된 파일 없음"
                tabindex="0"
                role="button"
                aria-label="재직 증빙 파일을 업로드하려면 클릭하거나 파일을 끌어다 놓으세요"
                aria-describedby="employmentProofNote"
              >
                <div class="file-drop-default">
                  <strong>클릭 또는 드래그해서 업로드</strong>
                  <span class="file-drop-hint">건강보험 자격득실·4대보험·사업자등록증 등 증빙 자료를 첨부해주세요.</span>
                </div>
                <div class="file-drop-selected">
                  <span class="file-drop-check" aria-hidden="true">✔</span>
                  <span class="file-drop-files">선택된 파일 없음</span>
                </div>
              </div>
              <div class="field-note" id="employmentProofNote">
                <p>건강보험 자격득실, 4대보험 가입증명서, 사업자등록증, 급여명세서도 가능합니다.</p>
                <p>프리랜서는 매니저에게 별도 문의해 주시면 방법을 안내합니다.</p>
              </div>
            </div>
            <div class="field">
              <label for="profilePhotos">
                프로필 사진 업로드 (2장 이상)
                <span class="badge-public" aria-hidden="true">공개</span>
                <span class="sr-only">상대방에게 공개되는 정보</span>
              </label>
              <input
                id="profilePhotos"
                class="file-input"
                type="file"
                accept="image/*"
                multiple
                aria-describedby="profilePhotosNote"
              />
              <div
                class="file-drop-zone"
                data-target="profilePhotos"
                data-placeholder="선택된 파일 없음"
                tabindex="0"
                role="button"
                aria-label="프로필 사진을 업로드하려면 클릭하거나 파일을 끌어다 놓으세요"
                aria-describedby="profilePhotosNote"
              >
                <div class="file-drop-default">
                  <strong>클릭 또는 드래그해서 업로드</strong>
                  <span class="file-drop-hint">최소 2장의 최신 얼굴·전신 사진을 첨부해주세요.</span>
                </div>
                <div class="file-drop-selected">
                  <span class="file-drop-check" aria-hidden="true">✔</span>
                  <span class="file-drop-files">선택된 파일 없음</span>
                </div>
              </div>
              <div class="field-note" id="profilePhotosNote">
                <p>근 6개월 내, 현재와 가장 비슷한 사진 2장을 첨부해주세요.</p>
                <ul>
                  <li>얼굴 사진 1장 (마스크 착용 불가)</li>
                  <li>전신 사진 1장 (얼굴이 보이는 전신)</li>
                </ul>
                <p>1:1 매칭 시 상대에게 공개될 수 있는 사진입니다. 본연의 매력을 담아주세요!</p>
                <p>간혹 실물과 사진이 다른 경우가 있어 첫 느낌을 좌우하니 신경 써주시면 감사하겠습니다.</p>
              </div>
            </div>
          </div>
        </fieldset>

        <div class="agreements-group">
          <div class="agreement-item">
            <div class="agreement-header">
              <label class="agreements">
                <input id="agreementInfo" type="checkbox" required />
                <span>
                  개인정보 수집 및 활용, 책임 및 면책 조항을 확인하고 동의합니다.
                </span>
              </label>
              <button
                type="button"
                class="agreement-toggle"
                data-target="agreementInfoDetails"
                aria-expanded="false"
                aria-label="개인정보 수집 및 활용 세부 내용 보기"
                data-label-close="개인정보 수집 및 활용 세부 내용 보기"
                data-label-open="개인정보 수집 및 활용 세부 내용 닫기"
              ></button>
            </div>
            <div id="agreementInfoDetails" class="agreement-details" hidden>
              <p>
                제출하신 개인정보는 신청자 확인과 매칭 진행을 위한 용도로만 사용되며, 매칭 종료 후 즉시 파기됩니다.
                허위 정보 기재 시 민/형사상 책임이 발생할 수 있으니 정확하게 작성해주세요.
              </p>
            </div>
          </div>
          <div class="agreement-item">
            <div class="agreement-header">
              <label class="agreements">
                <input id="agreementManners" type="checkbox" required />
                <span>
                  매너있는 대화 및 만남에 대한 동의 사항(잠수, 일방 취소 시 벌금 등)을 확인했습니다.
                </span>
              </label>
              <button
                type="button"
                class="agreement-toggle"
                data-target="agreementMannersDetails"
                aria-expanded="false"
                aria-label="동의 사항 세부 내용 보기"
                data-label-close="동의 사항 세부 내용 보기"
                data-label-open="동의 사항 세부 내용 닫기"
              ></button>
            </div>
            <div id="agreementMannersDetails" class="agreement-details" hidden>
              <p>
                상대방과의 약속을 존중하고 잠수나 일방 취소 등 비매너 행위 발생 시 안내된 벌금 및 제재가 적용됩니다.
                또한 상대방 프로필의 캡처, 저장, 유포 및 상업적 이용은 금지되며, 위반 시 법적 책임이 따를 수 있습니다.
              </p>
            </div>
          </div>
        </div>
        <div class="submit-row">
          <button type="submit" id="submitButton">프로필 정보 제출하기</button>
          <p class="form-message" id="formMessage" role="status" aria-live="polite"></p>
        </div>
        <div
          id="submissionModal"
          class="modal-backdrop"
          hidden
          role="dialog"
          aria-modal="true"
          aria-labelledby="submissionModalMessage"
        >
          <div class="modal-dialog">
            <p id="submissionModalMessage">프로필 정보 제출이 성공했습니다!</p>
            <button type="button" id="submissionModalClose">확인</button>
          </div>
        </div>
      </form>
    </div>

    <script src="backend-config.js"></script>
    <script>
      const HOSTNAME = window.location && window.location.hostname
      const IS_LOCAL_HOST = /^(localhost|127\\.0\\.0\\.1)$/i.test(HOSTNAME || '')
      const DEFAULT_BACKEND_ORIGIN = IS_LOCAL_HOST
        ? 'http://localhost:5000'
        : 'https://ygsa-backend.onrender.com'
      const BACKEND_ORIGIN_RAW = (window.BACKEND_ORIGIN || '').trim()
      const BACKEND_ORIGIN = (BACKEND_ORIGIN_RAW || DEFAULT_BACKEND_ORIGIN).replace(/\/$/, '')
      const API_BASE_URL = BACKEND_ORIGIN
      const PROFILE_API_URL = `${API_BASE_URL}/api/consult/profile`
      const DRAFT_STORAGE_KEY = 'alphaProfileDraft_v1'

      const formEl = document.getElementById('profileForm')
      const submitBtn = document.getElementById('submitButton')
      const messageEl = document.getElementById('formMessage')

      const phoneInput = document.getElementById('profilePhone')
      const jobInput = document.getElementById('profileJob')
      const mbtiInput = document.getElementById('profileMbti')
      const universityInput = document.getElementById('profileUniversity')
      const salaryRangeSelect = document.getElementById('profileSalaryRange')
      const jobDetailInput = document.getElementById('profileJobDetail')
      const appealInput = document.getElementById('profileAppeal')
      const smokingSelect = document.getElementById('profileSmoking')
      const religionSelect = document.getElementById('profileReligion')
      const sufficientInput = document.getElementById('profileSufficientCondition')
      const necessaryInput = document.getElementById('profileNecessaryCondition')
      const likesDislikesInput = document.getElementById('profileLikesDislikes')
      const aboutMeInput = document.getElementById('profileAboutMe')
      const preferredHeightsSelect = document.getElementById('profilePreferredHeights')
      const preferredAgesSelect = document.getElementById('profilePreferredAges')
      const valuesSelect = document.getElementById('profileValues')
      const idCardInput = document.getElementById('profileIdCard')
      const employmentProofInput = document.getElementById('profileEmploymentProof')
      const photosInput = document.getElementById('profilePhotos')
      const agreementInfo = document.getElementById('agreementInfo')
      const agreementManners = document.getElementById('agreementManners')
      const agreementToggles = Array.from(document.querySelectorAll('.agreement-toggle'))
      const draftSaveButton = document.getElementById('draftSaveButton')
      const draftLoadButton = document.getElementById('draftLoadButton')
      const fileDropZones = Array.from(document.querySelectorAll('.file-drop-zone'))
      const submissionModal = document.getElementById('submissionModal')
      const submissionModalCloseBtn = document.getElementById('submissionModalClose')

      let selectedValues = []

      if (phoneInput) {
        const applyPhoneFormatting = () => {
          const isActive = document.activeElement === phoneInput
          const selectionStart = phoneInput.selectionStart ?? 0
          const digitsBeforeCursor = String(phoneInput.value)
            .slice(0, selectionStart)
            .replace(/[^0-9]/g, '')
          const formatted = formatPhoneNumber(phoneInput.value)
          phoneInput.value = formatted

          if (isActive && typeof phoneInput.setSelectionRange === 'function') {
            let nextCursor = 0
            let digitsSeen = 0
            const targetDigits = digitsBeforeCursor.length
            while (nextCursor < formatted.length && digitsSeen < targetDigits) {
              if (/[0-9]/.test(formatted.charAt(nextCursor))) {
                digitsSeen++
              }
              nextCursor++
            }
            phoneInput.setSelectionRange(nextCursor, nextCursor)
          }
        }

        phoneInput.addEventListener('input', applyPhoneFormatting)
        phoneInput.addEventListener('blur', applyPhoneFormatting)
        applyPhoneFormatting()
      }

      if (valuesSelect) {
        valuesSelect.addEventListener('change', () => enforceValuesLimit(valuesSelect, 1))
      }

      function formatPhoneNumber(raw) {
        const digits = String(raw || '').replace(/[^0-9]/g, '')
        if (!digits) return ''
        if (digits.length <= 3) return digits
        if (digits.length <= 7) return digits.replace(/(\\d{3})(\\d+)/, '$1-$2')
        return digits.replace(/(\\d{3})(\\d{3,4})(\\d{0,4}).*/, (_, a, b, c) =>
          c ? `${a}-${b}-${c}` : `${a}-${b}`
        )
      }

      function getMultiSelectValues(selectEl) {
        if (!selectEl) return []
        if (!selectEl.multiple) {
          const value = selectEl.value
          return value ? [value] : []
        }
        return Array.from(selectEl.selectedOptions || [])
          .map((option) => option.value)
          .filter(Boolean)
      }

      function setMultiSelectValues(selectEl, values) {
        if (!selectEl) return
        const list = Array.isArray(values) ? values : []
        if (!selectEl.multiple) {
          selectEl.value = list[0] || ''
          return
        }
        const set = new Set(list)
        Array.from(selectEl.options || []).forEach((option) => {
          option.selected = set.has(option.value)
        })
      }

      function enforceValuesLimit(selectEl, limit) {
        if (!selectEl) return
        const selected = getMultiSelectValues(selectEl)
        if (!selectEl.multiple) {
          selectedValues = selected
          showMessage('', '')
          return
        }
        if (selected.length > limit) {
          setMultiSelectValues(selectEl, selectedValues)
          showMessage(`가치관은 최대 ${limit}개까지 선택할 수 있습니다.`, 'error')
        } else {
          selectedValues = selected
          showMessage('', '')
        }
      }

      function readFileAsDataUrl(file) {
        return new Promise((resolve, reject) => {
          const reader = new FileReader()
          reader.onload = () => resolve(reader.result)
          reader.onerror = () => reject(reader.error || new Error('파일을 읽지 못했습니다.'))
          reader.readAsDataURL(file)
        })
      }

      async function serializeFile(file) {
        if (!file) return null
        const dataUrl = await readFileAsDataUrl(file)
        return {
          name: file.name || '',
          size: Number(file.size) || 0,
          type: file.type || '',
          dataUrl: typeof dataUrl === 'string' ? dataUrl : '',
        }
      }

      function updateFileDropSummary(zone, inputEl) {
        if (!zone) return
        const summaryEl = zone.querySelector('.file-drop-files')
        const placeholder = zone.dataset.placeholder || '선택된 파일 없음'
        if (!summaryEl || !inputEl) {
          if (summaryEl) summaryEl.textContent = placeholder
          return
        }
        const files = Array.from(inputEl.files || [])
        const hasFiles = files.length > 0
        zone.classList.toggle('has-files', hasFiles)
        if (!hasFiles) {
          summaryEl.textContent = placeholder
          return
        }
        if (!inputEl.multiple) {
          summaryEl.textContent = files[0].name
          return
        }
        const names = files.map((file) => file.name)
        summaryEl.textContent =
          names.length <= 3 ? names.join(', ') : `${names.slice(0, 3).join(', ')} 외 ${names.length - 3}개`
      }

      fileDropZones.forEach((zone) => {
        const targetId = zone.dataset.target
        const inputEl = document.getElementById(targetId)
        if (!inputEl) return

        updateFileDropSummary(zone, inputEl)

        zone.addEventListener('click', (event) => {
          event.preventDefault()
          inputEl.click()
        })

        zone.addEventListener('keydown', (event) => {
          if (event.key === 'Enter' || event.key === ' ') {
            event.preventDefault()
            inputEl.click()
          }
        })

        zone.addEventListener('dragenter', (event) => {
          event.preventDefault()
          zone.classList.add('is-dragover')
        })

        zone.addEventListener('dragover', (event) => {
          event.preventDefault()
          if (event.dataTransfer) {
            event.dataTransfer.dropEffect = 'copy'
          }
          zone.classList.add('is-dragover')
        })

        zone.addEventListener('dragleave', () => {
          zone.classList.remove('is-dragover')
        })

        zone.addEventListener('drop', (event) => {
          event.preventDefault()
          zone.classList.remove('is-dragover')
          const incomingFiles = Array.from(event.dataTransfer?.files || [])
          if (!incomingFiles.length) return
          if (typeof DataTransfer === 'undefined') return

          const filesToUse = inputEl.multiple ? incomingFiles : [incomingFiles[0]].filter(Boolean)
          const dataTransfer = new DataTransfer()
          filesToUse.forEach((file) => dataTransfer.items.add(file))
          inputEl.files = dataTransfer.files

          updateFileDropSummary(zone, inputEl)
          inputEl.dispatchEvent(new Event('change', { bubbles: true }))
        })

        inputEl.addEventListener('change', () => updateFileDropSummary(zone, inputEl))
      })

      function collectDraftData() {
        const values = valuesSelect ? getMultiSelectValues(valuesSelect) : []
        return {
          phone: phoneInput?.value || '',
          mbti: mbtiInput?.value || '',
          job: jobInput?.value || '',
          jobDetail: jobDetailInput?.value || '',
          university: universityInput?.value || '',
          salaryRange: salaryRangeSelect?.value || '',
          smoking: smokingSelect?.value || '',
          religion: religionSelect?.value || '',
          profileAppeal: appealInput?.value || '',
          likesDislikes: likesDislikesInput?.value || '',
          sufficientCondition: sufficientInput?.value || '',
          necessaryCondition: necessaryInput?.value || '',
          aboutMe: aboutMeInput?.value || '',
          preferredHeights: preferredHeightsSelect?.value || '',
          preferredAges: preferredAgesSelect?.value || '',
          values,
          agreements: {
            info: agreementInfo?.checked || false,
            manners: agreementManners?.checked || false,
          },
          savedAt: Date.now(),
        }
      }

      function applyDraftData(draft) {
        if (!draft || typeof draft !== 'object') return
        if (phoneInput) {
          phoneInput.value = draft.phone || ''
          phoneInput.dispatchEvent(new Event('input'))
        }
        if (mbtiInput) mbtiInput.value = draft.mbti || ''
        if (jobInput) jobInput.value = draft.job || ''
        if (jobDetailInput) jobDetailInput.value = draft.jobDetail || ''
        if (universityInput) universityInput.value = draft.university || ''
        if (salaryRangeSelect) salaryRangeSelect.value = draft.salaryRange || ''
        if (smokingSelect) smokingSelect.value = draft.smoking || ''
        if (religionSelect) religionSelect.value = draft.religion || ''
        if (appealInput) appealInput.value = draft.profileAppeal || ''
        if (likesDislikesInput) likesDislikesInput.value = draft.likesDislikes || ''
        if (sufficientInput) sufficientInput.value = draft.sufficientCondition || ''
        if (necessaryInput) necessaryInput.value = draft.necessaryCondition || ''
        if (aboutMeInput) aboutMeInput.value = draft.aboutMe || ''
        if (preferredHeightsSelect) preferredHeightsSelect.value = draft.preferredHeights || ''
        if (preferredAgesSelect) preferredAgesSelect.value = draft.preferredAges || ''

        const draftValues = Array.isArray(draft.values) ? draft.values.slice(0, 1) : []
        if (valuesSelect) {
          setMultiSelectValues(valuesSelect, draftValues)
        }
        selectedValues = draftValues

        if (agreementInfo) agreementInfo.checked = Boolean(draft.agreements?.info)
        if (agreementManners) agreementManners.checked = Boolean(draft.agreements?.manners)

        fileDropZones.forEach((zone) => {
          const targetId = zone.dataset.target
          const inputEl = targetId ? document.getElementById(targetId) : null
          if (inputEl) {
            inputEl.value = ''
          }
          updateFileDropSummary(zone, inputEl)
        })
      }

      draftSaveButton?.addEventListener('click', () => {
        try {
          const draft = collectDraftData()
          localStorage.setItem(DRAFT_STORAGE_KEY, JSON.stringify(draft))
          alert('입력한 내용을 임시 저장했습니다.')
        } catch (error) {
          console.error('[draft] save failed', error)
          showMessage('임시 저장에 실패했습니다. 브라우저 저장소를 확인해주세요.', 'error')
        }
      })

      draftLoadButton?.addEventListener('click', () => {
        try {
          const raw = localStorage.getItem(DRAFT_STORAGE_KEY)
          if (!raw) {
            alert('저장된 임시 데이터가 없습니다.')
            return
          }
          const draft = JSON.parse(raw)
          applyDraftData(draft)
          showMessage('임시 저장된 데이터를 불러왔습니다. 제출 전 내용을 확인해주세요.', 'success')
        } catch (error) {
          console.error('[draft] load failed', error)
          showMessage('임시 데이터를 불러오지 못했습니다.', 'error')
        }
      })

      function openSubmissionModal() {
        if (!submissionModal) return
        submissionModal.hidden = false
        submissionModalCloseBtn?.focus()
      }

      function closeSubmissionModal() {
        if (!submissionModal) return
        submissionModal.hidden = true
      }

      agreementToggles.forEach((button) => {
        const targetId = button.dataset.target
        const detailsEl = document.getElementById(targetId)
        if (!detailsEl) return
        const closeLabel = button.dataset.labelClose || button.getAttribute('aria-label') || ''
        const openLabel = button.dataset.labelOpen || closeLabel
        button.addEventListener('click', () => {
          const isHidden = detailsEl.hasAttribute('hidden')
          if (isHidden) {
            detailsEl.removeAttribute('hidden')
          } else {
            detailsEl.setAttribute('hidden', '')
          }
          button.setAttribute('aria-expanded', isHidden ? 'true' : 'false')
          button.setAttribute('aria-label', isHidden ? openLabel : closeLabel)
        })
      })

      submissionModalCloseBtn?.addEventListener('click', () => closeSubmissionModal())
      submissionModal?.addEventListener('click', (event) => {
        if (event.target === submissionModal) {
          closeSubmissionModal()
        }
      })
      document.addEventListener('keydown', (event) => {
        if (event.key === 'Escape' && submissionModal && !submissionModal.hidden) {
          closeSubmissionModal()
        }
      })

      function showMessage(text, type) {
        if (!messageEl) return
        messageEl.textContent = text
        messageEl.classList.remove('success', 'error')
        if (type) {
          messageEl.classList.add(type)
        }
      }

      function setSubmitting(isSubmitting) {
        if (submitBtn) {
          submitBtn.disabled = isSubmitting
          submitBtn.textContent = isSubmitting ? '전송 중…' : '프로필 정보 제출하기'
        }
      }

      formEl?.addEventListener('submit', async (event) => {
        event.preventDefault()
        showMessage('', '')

        if (!formEl.reportValidity()) {
          showMessage('누락된 항목이 없는지 확인해주세요.', 'error')
          return
        }

        const values = getMultiSelectValues(valuesSelect)
        if (values.length > 1) {
          showMessage('가치관은 한 개만 선택해주세요.', 'error')
          return
        }
        selectedValues = values

        if (!agreementInfo.checked || !agreementManners.checked) {
          showMessage('모든 동의 항목에 체크해주세요.', 'error')
          return
        }

        let idCardUpload = null
        let employmentUpload = null
        let photosUpload = []
        try {
          idCardUpload =
            idCardInput?.files && idCardInput.files[0] ? await serializeFile(idCardInput.files[0]) : null
          employmentUpload =
            employmentProofInput?.files && employmentProofInput.files[0]
              ? await serializeFile(employmentProofInput.files[0])
              : null
          const photoFiles = photosInput?.files ? Array.from(photosInput.files) : []
          if (photoFiles.length) {
            const serializedPhotos = await Promise.all(photoFiles.map((file) => serializeFile(file)))
            photosUpload = serializedPhotos.filter(Boolean)
          }
        } catch (error) {
          console.error('[attachments] serialize failed', error)
          showMessage('첨부 파일을 읽어오지 못했습니다. 다시 시도해주세요.', 'error')
          return
        }

        const documentsPayload = {}
        if (idCardUpload) documentsPayload.idCard = idCardUpload
        if (employmentUpload) documentsPayload.employmentProof = employmentUpload

        const payload = {
          phone: formatPhoneNumber(phoneInput?.value || ''),
          mbti: mbtiInput?.value?.trim() || '',
          job: jobInput?.value?.trim() || '',
          university: universityInput?.value?.trim() || '',
          salaryRange: salaryRangeSelect?.value || '',
          jobDetail: jobDetailInput?.value?.trim() || '',
          profileAppeal: appealInput?.value?.trim() || '',
          smoking: smokingSelect?.value || '',
          religion: religionSelect?.value || '',
          sufficientCondition: sufficientInput?.value?.trim() || '',
          necessaryCondition: necessaryInput?.value?.trim() || '',
          likesDislikes: likesDislikesInput?.value?.trim() || '',
          aboutMe: aboutMeInput?.value?.trim() || '',
          preferredHeights: getMultiSelectValues(preferredHeightsSelect),
          preferredAges: getMultiSelectValues(preferredAgesSelect),
          values,
          valuesCustom: '',
          agreements: {
            info: agreementInfo.checked,
            manners: agreementManners.checked,
          },
          documents: documentsPayload,
          photos: photosUpload,
        }

        if (!payload.phone) {
          showMessage('연락처를 입력해주세요.', 'error')
          return
        }

        try {
          setSubmitting(true)
          const res = await fetch(PROFILE_API_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload),
          })
          const body = await res.json().catch(() => ({}))

          if (!res.ok || !body?.ok) {
            const message =
              body?.message ||
              (res.status === 404 ? '예약한 번호가 없습니다.' : '프로필 저장에 실패했습니다.')
            throw new Error(message)
          }
          openSubmissionModal()
          formEl.reset()
          selectedValues = []
          setMultiSelectValues(valuesSelect, [])
          setMultiSelectValues(preferredHeightsSelect, [])
          setMultiSelectValues(preferredAgesSelect, [])
          fileDropZones.forEach((zone) => {
            const targetId = zone.dataset.target
            const inputEl = targetId ? document.getElementById(targetId) : null
            if (inputEl) {
              inputEl.value = ''
            }
            updateFileDropSummary(zone, inputEl)
          })
          agreementToggles.forEach((button) => {
            const targetId = button.dataset.target
            const detailsEl = document.getElementById(targetId)
            if (detailsEl) {
              detailsEl.setAttribute('hidden', '')
            }
            button.setAttribute('aria-expanded', 'false')
            const closeLabel = button.dataset.labelClose || button.getAttribute('aria-label') || ''
            button.setAttribute('aria-label', closeLabel)
          })
        } catch (error) {
          const message = error?.message || '프로필 저장에 실패했습니다. 다시 시도해주세요.'
          showMessage(message, 'error')
        } finally {
          setSubmitting(false)
        }
      })
    </script>
  </body>
</html>

